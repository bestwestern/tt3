var solution;(function(n){var i=function(){function n(){this.durationindex=[],this.eventindex=[]}return n}(),t,r;n.tildeling=i,t=function(){function n(){this.tider=[];for(var n=0;n<antaltider;n++)this.tider.push(new i)}return n}(),n.restider=t,r=function(){function n(){var n,i,r,u,f;for(this.resmangeltildelinger=[],this.tidmangeltildelinger=[],this.restiltid=[],n=0;n<antalresourcer;n++)this.restiltid[n]=new t;for(n=0;n<antalevents;n++)if(i=events[n],i.preasigntime)for(r=0;r<i.duration;r++)for(u=0;u<i.eventresourcer.length;u++)f=i.eventresourcer[u].index,this.restiltid[f].tider[i.preasigntime.index+r].durationindex.push(r),this.restiltid[f].tider[i.preasigntime.index+r].eventindex.push(i.index)}return n.prototype.udregncon=function(n){for(var ir=n?hardconstraints:softconstraints,ut={},ui={},fi,ei,oi,ft,ar,si,hi,et,a,d,nt,li,lt,vi,gt,o,at,vt,yi,tt,ti,sr,c,e,v,yr,t,l,wi,cr,bi,ri,i,lr,k,pt,u,wt,pr,ki,di,s,gi,r,bt,nr,tr,rt,kt=0,rr=ir.length;kt<rr;kt++){var t=ir[kt],f=[],dt=0,h="";if(t instanceof instans.AssignResourceConstraint)for(h="AssignResourceConstraint",c=t.appliestoresmangler,i=0;i<c.length;i++)this.resmangeltildelinger[c[i].index]==null&&(c[i].aevent.preasigntime?f.push(c[i].aevent.duration):f.push(1));if(t instanceof instans.AssignTimeConstraint)for(h="AssignTimeConstraint",i=0,l=t.appliestoev.length;i<l;i++){for(e=0,fi=t.appliestoev[i].eventtidmangler,u=0;u<fi.length;u++)this.tidmangeltildelinger[fi[u].index]==null&&e++;f.push(e)}if(t instanceof instans.AvoidSplitAssignmentsConstraint)for(h="AvoidSplitAssignmentsConstraint",ei=t.arraymedarrayafresmangler,i=0;i<ei.length;i++){for(oi=ei[i],ft=[],u=0;u<oi.length;u++)v=this.resmangeltildelinger[oi[u].index],v!=undefined?ft.indexOf(v)==-1&&ft.push(v):ar=3;ft.length>1&&f.push(ft.length-1)}if(t instanceof instans.AvoidClashesConstraint)for(h="AvoidClashesConstraint",i=0;i<t.appliestores.length;i++){for(si=0,hi=t.appliestores[i].index,et=0;et<antaltider;et++)this.restiltid[hi].tider[et].durationindex.length>1&&(si+=this.restiltid[hi].tider[et].durationindex.length-1);f.push(si)}if(t instanceof instans.DistributeSplitEventsConstraint)for(h="DistributeSplitEventsConstraint",t=t,i=0,l=t.appliestoev.length;i<l;i++)e=this.getdistributespliteventafvigelse(t.appliestoev[i],t),e>0&&f.push(e);if(t instanceof instans.AvoidUnavailableTimesConstraint){h="AvoidUnavailableTimesConstraint";var ur=t.timer,vr=ur.length,t=t;for(i=0;i<t.appliestores.length;i++){var a=t.appliestores[i],ci=0,d=this.restiltid[a.index];for(u=0;u<vr;u++)d.tider[ur[u].index].eventindex.length>0&&ci++;ci&&f.push(ci)}}if(t instanceof instans.LimitBusyTimesConstraint){h="LimitBusyTimesConstraint";var g=t.timegroups,fr=g.length,y=t.maximum,p=t.minimum,t=t;for(i=0;i<t.appliestores.length;i++)for(a=t.appliestores[i],d=this.restiltid[a.index],u=0;u<fr;u++){for(nt=0,li=g[u].timer,r=0;r<li.length;r++)d.tider[li[r].index].eventindex.length>0&&nt++;nt>y?f.push(nt-y):nt<p&&f.push(p-nt)}}if(t instanceof instans.LimitIdleTimesConstraint){h="LimitIdleTimesConstraint";var g=t.timegroups,fr=g.length,y=t.maximum,p=t.minimum,t=t;for(i=0;i<t.appliestores.length;i++){var a=t.appliestores[i],ot=0,ai=this.restiltid[a.index].tider;for(u=0;u<g.length;u++){for(var st=g[u].timer,ht=0,ct=-1,b=0;ct<0&&b<st.length;)ai[st[b++].index].eventindex.length&&(ct=b-1);if(ct>-1){for(lt=-1,b=st.length-1;lt<0&&b>-1;)ai[st[b--].index].eventindex.length&&(lt=b+1);if(ct>-1&&lt>-1)for(r=ct+1;r<lt;r++)ai[st[r].index].eventindex.length||ht++;ht<p?ot+=p-ht:ht>y&&(ot+=ht-y)}}ot&&(f.push(ot),ui[a.name+"_"+t.name]=ot)}}if(t instanceof instans.LimitWorkloadConstraint){h="LimitWorkloadConstraint ";var t=t,y=t.maximum,p=t.minimum;for(i=0;i<t.appliestores.length;i++){var a=t.appliestores[i],er=[],w=0,d=this.restiltid[a.index];for(u=0;u<antaltider;u++)for(vi=d.tider[u],r=0;r<vi.eventindex.length;r++)if(gt=vi.eventindex[r],er.indexOf(gt)==-1){for(o=events[gt],er.push(gt),at=o.eventresmangler,s=0;s<at.length;s++)this.resmangeltildelinger[at[s].index]==a.index&&(vt=o.preasigntime?o.duration:1,w+=at[s].workload!=null?at[s].workload/o.duration*vt:o.workload!=null?o.workload/o.duration*vt:vt);for(s=0;s<o.eventresourcer.length;s++)o.eventresourcer[s]===a&&(w+=o.eventresworkloads[s]!=null?o.eventresworkloads[s]*o.duration:o.workload!=null?o.workload*o.duration:o.duration)}w=Math.ceil(w),w>y?f.push(w-y):w<p&&f.push(p-w)}}if(t instanceof instans.LinkEventsConstraint)for(h="LinkEventsConstraint ",t=t,yi=t.appliestoevgrou,i=0;i<yi.length;i++){var k=yi[i],wr=k.events[0].duration,ni=[],yt=[];for(u=0;u<k.events.length;u++){var o=k.events[u],pi=[],or=o.eventtidmangler;for(r=0;r<or.length;r++)tt=this.tidmangeltildelinger[or[r].index],tt!=null&&(pi.indexOf(tt)==-1&&pi.push(tt),ni.indexOf(tt)==-1&&ni.push(tt));yt.push(pi)}for(ti=0,u=0;u<ni.length;u++){for(sr=ni[u],r=0;r<yt.length;r++)yt[r].indexOf(sr)==-1&&(r=yt.length+1);r>yt.length&&ti++}ti&&f.push(ti)}if(t instanceof instans.SplitEventsConstraint)for(h="SplitEventsConstraint",t=t,i=0,l=t.appliestoev.length;i<l;i++)e=this.getspliteventafvigelse(t.appliestoev[i],t),e>0&&f.push(e);if(t instanceof instans.PreferResourcesConstraint)for(h="PreferResourcesConstraint",t=t,c=t.appliestoresmangler,i=0;i<c.length;i++)e=0,v=this.resmangeltildelinger[c[i].index],v!=undefined&&t.appliestores.indexOf(resourcer[v])<0&&(c[i].aevent.preasigntime?e+=c[i].aevent.duration:e++),f.push(e);if(t instanceof instans.PreferTimesConstraint)for(h="PreferTimesConstraint",yr=t.duration,t=t,i=0,l=t.appliestoev.length;i<l;i++){var e=0,hr=t.appliestoev[i],it=this.getdurations(hr);for(r=0;r<it.length;r=r+2)wi=!0,"duration"in t&&(wi=it[r+1]-it[r]+1==t.duration),wi&&(cr=hr.eventtidmangler[it[r]].index,bi=this.tidmangeltildelinger[cr],bi!=null&&t.timer.indexOf(timer[bi])<0&&(e=e+it[r+1]-it[r]+1));f.push(e)}if(t instanceof instans.SpreadEventsConstraint){h="SpreadEventsConstraint";var t=t,ii=[];for(i=0;i<ri;i++)ii.push(0);for(ri=t.timegroupminimum.length,i=0,lr=t.appliestoevgrou.length;i<lr;i++){for(k=t.appliestoevgrou[i],u=0;u<ri;u++)ii[u]=0;for(pt=[],u=0;u<k.events.length;u++)if(wt=k.events[u],pr=[],wt.preasigntime)pt.push(wt.preasigntime);else for(ki=this.getdurations(wt),r=0;r<ki.length;r=r+2)pt.push(timer[this.tidmangeltildelinger[wt.eventtidmangler[ki[r]].index]]);for(r=0;r<pt.length;r++)for(di=pt[r],s=0;s<di.timegroups.length;s++)gi=t.timegroups.indexOf(di.timegroups[s]),gi>-1&&ii[gi]++;for(r=0;r<ri;r++)bt=ii[r],bt<t.timegroupminimum[r]?f.push(t.timegroupminimum[r]-bt):bt>t.timegroupmaximum[r]&&f.push(bt-t.timegroupmaximum[r])}}f.length>0&&(nr=document.createElement("li"),dt=t.costfunction(f)*t.weight,nr.appendChild(document.createTextNode(t.id+":"+dt.toString()+":"+f.toString())),tr=n?document.getElementById("hardcon"):document.getElementById("softcon"),tr.insertBefore(nr,tr.firstChild),h in ut?ut[h]+=dt:ut[h]=dt)}assert(!0,"-----------");for(rt in ut)assert(!0,rt+" "+ut[rt]);for(rt in ui)assert(!0,rt+" : "+ui[rt])},n.prototype.getdurations=function(n){for(var f=[],e=!0,t=0,o=n.eventtidmangler.length,i,u,r,s,h;e;)if(this.tidmangeltildelinger[n.eventtidmangler[t].index]!=null){for(f.push(t),i=!0;i;)if(t+2>o)i=!1,e=!1;else if(this.tidmangeltildelinger[n.eventtidmangler[t+1].index]!=null)if(this.tidmangeltildelinger[n.eventtidmangler[t].index]+1==this.tidmangeltildelinger[n.eventtidmangler[t+1].index]){for(u=!1,r=t+1;r<n.eventresmangler.length;r+=n.duration)s=vistsol.resmangeltildelinger[n.eventresmangler[r].index],h=vistsol.resmangeltildelinger[n.eventresmangler[r-1].index],s==h?u=!0:(u=!1,r=n.eventresmangler.length);u||n.eventresmangler.length==0?t++:i=!1}else i=!1;else i=!1;f.push(t++)}else t+2>o?e=!1:t++;return f},n.prototype.getspliteventafvigelse=function(n,t){var h=t.minimumduration,o=t.minimumamount,l=n.id,c=t.maximumduration,s=t.maximumamount,r=this.getdurations(n),u=0,i,e,f;if(r.length>0){for(i=0;i<r.length;i=i+2)e=r[i+1]-r[i]+1,e<h&&u++,e>c&&u++;f=r.length/2,f>s&&(u+=f-s),f<o&&(u+=o-f)}return u},n.prototype.getdistributespliteventafvigelse=function(n,t){var f=t.minimum,s=n.id,e=t.maximum,o=t.duration,u=this.getdurations(n),i,r;if(u.length>0)for(i=0,r=0;r<u.length;r=r+2)u[r+1]-u[r]+1==o&&i++;return i>e?i-e:i<f?f-i:0},n.prototype.randomtidtildel=function(n){for(var i,r,t=0;t<n;t++)i=Math.floor(Math.random()*tidmangler.length),r=Math.floor(Math.random()*antaltider),this.tildeltidtilevent(i,r)},n.prototype.randontildelres=function(n){for(var t,i,r,u,c,f=0;f<n;f++)if(t=Math.floor(Math.random()*resmangler.length),this.resmangeltildelinger[t]==undefined){for(i=-1;i<0;){var o=resmangler[t].resourcetype,h=Math.floor(Math.random()*o.resourcegroups.length),e=o.resourcegroups[h].resourcer,s=Math.floor(Math.random()*e.length);e[s]&&(i=e[s].index)}if(vistsol.resmangeltildelinger[t]=i,resmangler[t].aevent.preasigntime)for(r=resmangler[t].aevent,u=0;u<r.duration;u++)vistsol.tildelresourcetileventtiltid(i,0,r.preasigntime.index+u,r.index)}else c=3},n.prototype.tildeltidtilevent=function(n,t){var i=tidmangler[n].aevent,o=i.index,f=tidmangler[n].durationindex,e,u,s,r;for(this.tidmangeltildelinger[n]!=undefined&&(e=this.tidmangeltildelinger[n]),u=f;u<i.eventresmangler.length;u=u+i.duration)this.resmangeltildelinger[i.eventresmangler[u].index]!==undefined&&(r=this.resmangeltildelinger[i.eventresmangler[u].index],e!==undefined&&this.fratagresourcetileventtiltid(r,f,e,o),t>-1&&this.tildelresourcetileventtiltid(r,f,t,o));for(s=0;s<i.eventresourcer.length;s++)r=i.eventresourcer[s].index,e!==undefined&&this.fratagresourcetileventtiltid(r,f,e,o),t>-1&&this.tildelresourcetileventtiltid(r,f,t,o);this.tidmangeltildelinger[n]=t>-1?t:null},n.prototype.fratagresourcetileventtiltid=function(n,t,i,r){for(var f=this.restiltid[n].tider[i],e=-1,u=0;u<f.durationindex.length;u++)f.durationindex[u]==t&&f.eventindex[u]==r&&(e=u);e>-1&&(f.eventindex.splice(e,1),f.durationindex.splice(e,1))},n.prototype.tildelresourcetileventtiltid=function(n,t,i,r){var u=this.restiltid[n].tider[i];u.eventindex.push(r),u.durationindex.push(t)},n}(),n.Sol=r})(solution||(solution={}))