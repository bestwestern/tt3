function genberegn(){vistsol.udregncon(!0),vistsol.udregncon(!1),$("#content").html(lavtablerowhtml(vistsol))}function randomtid(){var n=$("#antalrandomtid").val();$("#randomresbutton").remove(),vistsol.randomtidtildel(n)}function randomres(){var n=$("#antalrandomtid").val();vistsol.randontildelres(n)}function tildeltid0(){for(var r=!1,n,t,u,i=0;i<events.length;i++)if(n=events[i],!n.preasigntime)for(t=0;t<n.duration;t++)u=timer[vistsol.tidmangeltildelinger[n.eventtidmangler[t].index]],u||(vistsol.tildeltidtilevent(n.eventtidmangler[t].index,0),r=!0);r&&($("#content").html(lavtablerowhtml(vistsol)),vistsol.udregncon(!0),vistsol.udregncon(!1))}function lavxmlserver(){tildeltid0()}function lavxml(){var l,a,e,n,tt,r,v,p,w,y,b,k,i,o,d,s,t,u,f,h;tildeltid0();var g=new XMLSerializer,it=xmlDoc.getElementsByTagName("Instances")[0],nt=xmlDoc.getElementsByTagName("SolutionGroups")[0],c=xmlDoc.createElement("SolutionGroup");for(c.setAttribute("Id","Runessol"+Math.random()*1e3),l=xmlDoc.createElement("Solution"),l.setAttribute("Reference",xmlinstans),a=addnode("Events",l),e=0;e<antalevents;e++)for(n=events[e],e==50&&(tt=4),r=0;r<n.duration;r++)if(n.preasigntime){if(r==0)for(i=addnode("Event",a),i.setAttribute("Reference",n.id),addnode("Duration",i,n.duration.toString()),o=addnode("Time",i),o.setAttribute("Reference",timer[n.preasigntime.index].id),s=addnode("Resources",i),t=0;t<n.eventresmangler.length;t++)u=vistsol.resmangeltildelinger[n.eventresmangler[t].index],u!=undefined&&(f=addnode("Resource",s),f.setAttribute("Reference",resourcer[u].id),addnode("Role",f,n.eventresmangler[t].role))}else{if(v=!0,r>0&&(p=vistsol.tidmangeltildelinger[n.eventtidmangler[r].index],w=vistsol.tidmangeltildelinger[n.eventtidmangler[r-1].index],p==w+1)){for(y=!0,t=r;t<n.eventresmangler.length;t+=n.duration)b=vistsol.resmangeltildelinger[n.eventresmangler[t].index],k=vistsol.resmangeltildelinger[n.eventresmangler[t-1].index],b!=k&&(y=!1);y&&(i.childNodes[0].childNodes[0].nodeValue=Number(i.childNodes[0].childNodes[0].nodeValue)+1,v=!1)}if(v)for(i=addnode("Event",a),i.setAttribute("Reference",n.id),addnode("Duration",i,"1"),o=addnode("Time",i),d=vistsol.tidmangeltildelinger[n.eventtidmangler[r].index],o.setAttribute("Reference",timer[d].id),s=addnode("Resources",i),t=r;t<n.eventresmangler.length;t+=n.duration)u=vistsol.resmangeltildelinger[n.eventresmangler[t].index],u!=undefined&&(f=addnode("Resource",s),f.setAttribute("Reference",resourcer[u].id),addnode("Role",f,n.eventresmangler[t].role))}h=xmlDoc.createElement("MetaData"),addnode("Contributor",h,"run@sdu.dk"),addnode("Date",h,(new Date).toDateString()),addnode("Description",h,"Speciale"),c.appendChild(h),c.appendChild(l),nt.appendChild(c),window.open("data:text/xml,"+g.serializeToString(xmlDoc))}function addnode(n,t,i){var r=xmlDoc.createElement(n),u;return i&&(u=xmlDoc.createTextNode("ch"),u.nodeValue=i,r.appendChild(u)),t.appendChild(r),r}function choicemade(n,t,i){var f=i.getAttribute("data-eventindex"),s=i.getAttribute("data-durationindex"),h=i.getAttribute("data-tidmangelindex"),r,e,u,o;if(n)r=Number(i.options[i.selectedIndex].value),isNaN(r)&&(r=-1),vistsol.tildeltidtilevent(t,r);else{if(r=Number(i.options[i.selectedIndex].value),e=vistsol.resmangeltildelinger[t],u=h<0?h*-1-1:vistsol.tidmangeltildelinger[h],u!=null)if(h<0)for(o=0;o<events[f].duration;o++)e!==undefined&&vistsol.fratagresourcetileventtiltid(e,s,u+o,f),isNaN(r)||vistsol.tildelresourcetileventtiltid(r,s,u+o,f);else e!==undefined&&vistsol.fratagresourcetileventtiltid(e,s,u,f),isNaN(r)||vistsol.tildelresourcetileventtiltid(r,s,u,f);vistsol.resmangeltildelinger[t]=isNaN(r)?null:r}$("#content").html(lavtablerowhtml(vistsol)),vistsol.udregncon(!0),vistsol.udregncon(!1)}function assert(n,t){var i=document.getElementById("results"),r;i||(i=document.createElement("ul"),document.getElementsByTagName("body")[0].appendChild(i),i.setAttribute("id","results")),r=document.createElement("li"),r.className=n?"pass":"fail",r.appendChild(document.createTextNode(t)),i.appendChild(r)}function lavtablerowhtml(n){for(var s="<table><thead><tr><td>Event<\/td><td>Time<\/td><\/tr><\/thead>",k={},lt=events.length,d=" <option> Not chosen<\/option> ",t,g,i,c,u,ft,f,a,v,nt,tt,e,et,y,p,ht,l,h,ct,rt,w,b,ut,r=0,o=timer.length;r<o;r++)d+="<option value='"+timer[r].index+"'>"+timer[r].name+"<\/option>";for(d+="<\/select>",r=0;r<lt;r++)for(t=events[r],g=t.eventresmangler.length,i=0;i<t.duration;i++){if(c=t.name,u="",t.preasigntime){if(i==0){for(t.duration>1&&(c+=" ("+t.duration+")"),f=0,o=t.eventresourcer.length;f<o;f++)u+=t.eventresourcer[f].name+", ";s+=u.length>0?"<tr title='"+u.substr(0,u.length-2)+"'><td>":"<tr><td>",ft=timer[t.preasigntime.index+i],s+=c+"<\/td><td>Time:"+ft.name+"<\/td>"}}else{for(t.duration>1&&(c+=" ("+(i+1)+"/"+t.duration+")"),f=0,o=t.eventresourcer.length;f<o;f++)u+=t.eventresourcer[f].name+", ";s+=u.length>0?"<tr title='"+u.substr(0,u.length-2)+"'><td>":"<tr><td>",a=d,v=n.tidmangeltildelinger[t.eventtidmangler[i].index],v>-2&&(a=a.replace("'"+v+"'","'"+v+"' selected")),s+=c+"<\/td><td>Time:<select  data-eventindex="+t.index+"  data-durationindex="+i+"  data-tidmangelindex="+t.eventtidmangler[i].index+"   onchange='choicemade(true,"+t.eventtidmangler[i].index+",this)'>"+a+"<\/td>"}for(nt=i,tt=t.duration,t.preasigntime&&(i==0?tt=1:nt=g),e=nt;e<g;e=e+tt){if(et=t.eventresmangler[e].role,y=t.eventresmangler[e].resourcetype.id,k[y]===undefined){var ot=[],it="<option>Not chosen<\/option>",st=t.eventresmangler[e].resourcetype.resourcegroups;for(p=0,ht=st.length;p<ht;p++)for(l=st[p].resourcer,h=0,ct=l.length;h<ct;h++)ot.indexOf(l[h].index)==-1&&(rt=l[h].index,ot.push(rt),it+="<option value='"+rt+"'>"+l[h].name+"<\/option>");it+="<\/select>",k[y]=it}w=k[y],b=n.resmangeltildelinger[t.eventresmangler[e].index],b>-2&&(w=w.replace("'"+b+"'","'"+b+"' selected")),ut=t.eventtidmangler[i]!=undefined?t.eventtidmangler[i].index:-(t.preasigntime.index+i)-1,s+="<td> "+et+":<select data-eventindex="+t.index+"  data-durationindex="+i+"  data-tidmangelindex="+ut+" onchange='choicemade(false,"+t.eventresmangler[e].index+",this)'>>"+w+"<\/td>"}}return s+"<\/table>"}var timer,vistsol,tidsgrupper,resourcetyper,resourcegrupper,resourcer,eventgrupper,events,antalevents,antalresourcer,antaltider,hardconstraints,softconstraints,resmangler,tidmangler,counter=0,xmlDoc,xmlinstans;window.onload=function(){"use strict";var n,r,t,i;if([][3]=[5],n=["DenmarkSmallSchool","test","NetherlandsKottenpark2009","ArtificialORLibrary-hdtt6","ArtificialSudoku4x4","AustraliaBGHS98","AustraliaSAHS96","BrazilInstance1","BrazilInstance4","DenmarkHasserisGymnasium2012","EnglandStPaul","GreeceHighSchool1","FinlandCollege","FinlandSecondarySchool","NetherlandsGEPRO","SouthAfricaLewitt2009","SpainSchool","ItalyInstance1"],r=0,r)for(t=0;t<n.length;t++)events=[],instans.readxml("XML/"+n[t]+".xml");i=n[2],instans.readxml("XML/"+i+".xml"),vistsol=new solution.Sol,$("#filnavn").text(n.indexOf(i)+":"+i),$("#content").html(lavtablerowhtml(vistsol))}