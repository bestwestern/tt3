function lavxml(){var y=new XMLSerializer,b=xmlDoc.getElementsByTagName("Instances")[0],p=xmlDoc.getElementsByTagName("SolutionGroups")[0],f=xmlDoc.createElement("SolutionGroup"),e,a,o,n,t,i,s,h,v,w,r,c,l,u;for(f.setAttribute("Id","Runessol"),e=xmlDoc.createElement("Solution"),e.setAttribute("Reference",xmlinstans),a=addnode("Events",e),o=0;o<antalevents;o++)for(n=events[o],t=0;t<n.duration;t++)for(i=addnode("Event",a),i.setAttribute("Reference",n.id),addnode("Duration",i,"1"),s=vistsol.tidmangeltildelinger[n.eventtidmangler[t].index],h=addnode("Time",i),s?h.setAttribute("Reference",timer[s].id):h.setAttribute("Reference",timer[0].id),v=addnode("Resources",i),n.eventresmangler.length>1&&(w=4),r=t;r<n.eventresmangler.length;r+=n.duration)c=vistsol.resmangeltildelinger[n.eventresmangler[r].index],c&&(l=addnode("Resource",v),l.setAttribute("Reference",resourcer[c].id),addnode("Role",l,n.eventresmangler[r].role));u=xmlDoc.createElement("MetaData"),addnode("Contributor",u,"run@sdu.dk"),addnode("Date",u,(new Date).toDateString()),addnode("Description",u,"Speciale"),f.appendChild(u),f.appendChild(e),p.appendChild(f),window.open("data:text/xml,"+y.serializeToString(xmlDoc))}function addnode(n,t,i){var r=xmlDoc.createElement(n),u;return i&&(u=xmlDoc.createTextNode("ch"),u.nodeValue=i,r.appendChild(u)),t.appendChild(r),r}function choicemade(n,t,i){var r,u;if(r=n?vistsol.tidmangeltildelinger:vistsol.resmangeltildelinger,u=Number(i.options[i.selectedIndex].value),!n){var e=r[t],o=i.getAttribute("data-eventindex"),s=i.getAttribute("data-durationindex"),h=i.getAttribute("data-tidmangelindex"),f=vistsol.tidmangeltildelinger[h];e!==null&&vistsol.fratagresourcetileventtiltid(e,s,f,o),f!=null&&vistsol.tildelresourcetileventtiltid(u,s,f,o)}r[t]=isNaN(u)?null:u,$("#content").html(lavtablerowhtml(vistsol)),vistsol.udregncon(!0),vistsol.udregncon(!1)}function assert(n,t){var i=document.getElementById("results"),r;i||(i=document.createElement("ul"),document.getElementsByTagName("body")[0].appendChild(i),i.setAttribute("id","results")),r=document.createElement("li"),r.className=n?"pass":"fail",r.appendChild(document.createTextNode(t)),i.appendChild(r)}function lavtablerowhtml(n){for(var e="<table><thead><tr><td>Event<\/td><td>Time<\/td><\/tr><\/thead>",k={},st=events.length,d=" <option> Not chosen<\/option> ",t,tt,r,c,s,l,it,a,v,u,rt,y,p,et,h,f,ot,nt,w,b,i=0,o=timer.length;i<o;i++)d+="<option value='"+timer[i].index+"'>"+timer[i].name+"<\/option>";for(d+="<\/select>",i=0;i<st;i++)for(t=events[i],tt=t.eventresmangler.length,r=0;r<t.duration;r++){for(c=t.name,s="",t.duration>1&&(c+=" ("+(r+1)+"/"+t.duration+")"),l=0,o=t.eventresourcer.length;l<o;l++)s+=t.eventresourcer[l].name+", ";for(e+=s.length>0?"<tr title='"+s.substr(0,s.length-2)+"'><td>":"<tr><td>",t.preasigntime?(it=timer[t.preasigntime.index+r],e+=c+"<\/td><td>Time:"+it.name+"<\/td>"):(a=d,v=n.tidmangeltildelinger[t.eventtidmangler[r].index],v>-2&&(a=a.replace("'"+v+"'","'"+v+"' selected")),e+=c+"<\/td><td>Time:<select onchange='choicemade(true,"+t.eventtidmangler[r].index+",this)'>"+a+"<\/td>"),u=r;u<tt;u=u+t.duration){if(rt=t.eventresmangler[u].role,y=t.eventresmangler[u].resourcetype.id,k[y]===undefined){var ut=[],g="<option>Not chosen<\/option>",ft=t.eventresmangler[u].resourcetype.resourcegroups;for(p=0,et=ft.length;p<et;p++)for(h=ft[p].resourcer,f=0,ot=h.length;f<ot;f++)ut.indexOf(h[f].index)==-1&&(nt=h[f].index,ut.push(nt),g+="<option value='"+nt+"'>"+h[f].name+"<\/option>");g+="<\/select>",k[y]=g}w=k[y],b=n.resmangeltildelinger[t.eventresmangler[u].index],b>-2&&(w=w.replace("'"+b+"'","'"+b+"' selected")),e+="<td> "+rt+":<select data-eventindex="+t.index+"  data-durationindex="+r+"  data-tidmangelindex="+t.eventtidmangler[r].index+" onchange='choicemade(false,"+t.eventresmangler[u].index+",this)'>>"+w+"<\/td>"}}return e+"<\/table>"}var timer,vistsol,tidsgrupper,resourcetyper,resourcegrupper,resourcer,eventgrupper,events,antalevents,antalresourcer,antaltider,hardconstraints,softconstraints,resmangler,tidmangler,counter=0,xmlDoc,xmlinstans;window.onload=function(){var n,i,t;if([][3]=[5],n=["DenmarkSmallSchool","test","NetherlandsKottenpark2009","ArtificialORLibrary-hdtt6","ArtificialSudoku4x4","AustraliaBGHS98","AustraliaSAHS96","BrazilInstance1","BrazilInstance4","DenmarkHasserisGymnasium2012","EnglandStPaul","GreeceHighSchool1","FinlandCollege","FinlandSecondarySchool","NetherlandsGEPRO","SouthAfricaLewitt2009","SpainSchool","ItalyInstance1"],i=0,i)for(t=0;t<n.length;t++)events=[],instans.readxml("XML/"+n[t]+".xml");instans.readxml("XML/"+n[2]+".xml"),vistsol=new solution.Sol,$("#content").html(lavtablerowhtml(vistsol))}