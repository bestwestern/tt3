var solution;(function(n){var i=function(){function n(){this.durationindex=[],this.eventindex=[]}return n}(),t,r;n.tildeling=i,t=function(){function n(){this.tider=[];for(var n=0;n<antaltider;n++)this.tider.push(new i)}return n}(),n.restider=t,r=function(){function n(){var n,i,r,u,f;for(this.resmangeltildelinger=[],this.tidmangeltildelinger=[],this.restiltid=[],n=0;n<antalresourcer;n++)this.restiltid[n]=new t;for(n=0;n<antalevents;n++)if(i=events[n],i.preasigntime)for(r=0;r<i.duration;r++)for(u=0;u<i.eventresourcer.length;u++)f=i.eventresourcer[u].index,this.restiltid[f].tider[i.preasigntime.index+r].durationindex.push(r),this.restiltid[f].tider[i.preasigntime.index+r].eventindex.push(i.index)}return n.prototype.udregncon=function(n){for(var wi=n?hardconstraints:softconstraints,it={},lt={},dt,gt,ni,rt,fr,ti,ii,ut,v,w,d,ui,fi,yt,o,ft,et,ei,oi,g,wt,tr,c,e,y,sr,t,l,hi,rr,ci,kt,i,ur,p,st,u,ht,hr,li,ai,s,vi,r,ct,yi,pi,tt,at=0,bi=wi.length;at<bi;at++){var t=wi[at],f=[],vt=0,h="";if(t instanceof instans.AssignResourceConstraint)for(h="AssignResourceConstraint",t=t,c=t.appliestoresmangler,i=0;i<c.length;i++)this.resmangeltildelinger[c[i].index]==null&&(c[i].aevent.preasigntime?f.push(c[i].aevent.duration):f.push(1));if(t instanceof instans.AssignTimeConstraint)for(h="AssignTimeConstraint",t=t,i=0,l=t.appliestoev.length;i<l;i++){for(e=0,dt=t.appliestoev[i].eventtidmangler,u=0;u<dt.length;u++)this.tidmangeltildelinger[dt[u].index]==null&&e++;f.push(e)}if(t instanceof instans.AvoidSplitAssignmentsConstraint)for(h="AvoidSplitAssignmentsConstraint",t=t,gt=t.arraymedarrayafresmangler,i=0;i<gt.length;i++){for(ni=gt[i],rt=[],u=0;u<ni.length;u++)y=this.resmangeltildelinger[ni[u].index],y!=undefined?rt.indexOf(y)==-1&&rt.push(y):fr=3;rt.length>1&&f.push(rt.length-1)}if(t instanceof instans.AvoidClashesConstraint)for(t=t,h="AvoidClashesConstraint",i=0;i<t.appliestores.length;i++){for(ti=0,ii=t.appliestores[i].index,ut=0;ut<antaltider;ut++)this.restiltid[ii].tider[ut].durationindex.length>1&&(ti+=this.restiltid[ii].tider[ut].durationindex.length-1);f.push(ti)}if(t instanceof instans.DistributeSplitEventsConstraint)for(h="DistributeSplitEventsConstraint",t=t,i=0,l=t.appliestoev.length;i<l;i++)e=this.getdistributespliteventafvigelse(t.appliestoev[i],t),e>0&&f.push(e);if(t instanceof instans.AvoidUnavailableTimesConstraint){h="AvoidUnavailableTimesConstraint";var ki=t.timer,er=ki.length,t=t;for(i=0;i<t.appliestores.length;i++){var v=t.appliestores[i],ri=0,w=this.restiltid[v.index];for(u=0;u<er;u++)w.tider[ki[u].index].eventindex.length>0&&ri++;ri&&f.push(ri)}}if(t instanceof instans.LimitBusyTimesConstraint){h="LimitBusyTimesConstraint";var di=t.timegroups,or=di.length,b=t.maximum,k=t.minimum,t=t;for(i=0;i<t.appliestores.length;i++)for(v=t.appliestores[i],w=this.restiltid[v.index],u=0;u<or;u++){for(d=0,ui=di[u].timer,r=0;r<ui.length;r++)w.tider[ui[r].index].eventindex.length>0&&d++;d>b?f.push(d-b):d<k&&f.push(k-d)}}if(t instanceof instans.LimitWorkloadConstraint){h="LimitWorkloadConstraint ";var t=t,b=t.maximum,k=t.minimum;for(i=0;i<t.appliestores.length;i++){var v=t.appliestores[i],gi=[],a=0,w=this.restiltid[v.index];for(u=0;u<antaltider;u++)for(fi=w.tider[u],r=0;r<fi.eventindex.length;r++)if(yt=fi.eventindex[r],gi.indexOf(yt)==-1){for(o=events[yt],gi.push(yt),ft=o.eventresmangler,s=0;s<ft.length;s++)this.resmangeltildelinger[ft[s].index]==v.index&&(et=o.preasigntime?o.duration:1,a+=ft[s].workload!=null?ft[s].workload/o.duration*et:o.workload!=null?o.workload/o.duration*et:et);for(s=0;s<o.eventresourcer.length;s++)o.eventresourcer[s]===v&&(a+=o.eventresworkloads[s]!=null?o.eventresworkloads[s]*o.duration:o.workload!=null?o.workload*o.duration:o.duration)}a=Math.ceil(a),ei=v.id+"___"+t.id,a>b?(f.push(a-b),lt[ei]=a-b):a<k&&(f.push(k-a),lt[ei]=k-a)}}if(t instanceof instans.LinkEventsConstraint)for(h="LinkEventsConstraint ",t=t,oi=t.appliestoevgrou,i=0;i<oi.length;i++){var p=oi[i],cr=p.events[0].duration,pt=[],ot=[];for(u=0;u<p.events.length;u++){var o=p.events[u],si=[],nr=o.eventtidmangler;for(r=0;r<nr.length;r++)g=this.tidmangeltildelinger[nr[r].index],g!=null&&(si.indexOf(g)==-1&&si.push(g),pt.indexOf(g)==-1&&pt.push(g));ot.push(si)}for(wt=0,u=0;u<pt.length;u++){for(tr=pt[u],r=0;r<ot.length;r++)ot[r].indexOf(tr)==-1&&(r=ot.length+1);r>ot.length&&wt++}wt&&f.push(wt)}if(t instanceof instans.SplitEventsConstraint)for(h="SplitEventsConstraint",t=t,i=0,l=t.appliestoev.length;i<l;i++)e=this.getspliteventafvigelse(t.appliestoev[i],t),e>0&&f.push(e);if(t instanceof instans.PreferResourcesConstraint)for(h="PreferResourcesConstraint",t=t,c=t.appliestoresmangler,i=0;i<c.length;i++)e=0,y=this.resmangeltildelinger[c[i].index],y!=undefined&&t.appliestores.indexOf(resourcer[y])<0&&(c[i].aevent.preasigntime?e+=c[i].aevent.duration:e++),f.push(e);if(t instanceof instans.PreferTimesConstraint)for(h="PreferTimesConstraint",sr=t.duration,t=t,i=0,l=t.appliestoev.length;i<l;i++){var e=0,ir=t.appliestoev[i],nt=this.getdurations(ir);for(r=0;r<nt.length;r=r+2)hi=!0,"duration"in t&&(hi=nt[r+1]-nt[r]+1==t.duration),hi&&(rr=ir.eventtidmangler[nt[r]].index,ci=this.tidmangeltildelinger[rr],ci!=null&&t.timer.indexOf(timer[ci])<0&&(e=e+nt[r+1]-nt[r]+1));f.push(e)}if(t instanceof instans.SpreadEventsConstraint){h="SpreadEventsConstraint";var t=t,bt=[];for(i=0;i<kt;i++)bt.push(0);for(kt=t.timegroupminimum.length,i=0,ur=t.appliestoevgrou.length;i<ur;i++){for(p=t.appliestoevgrou[i],u=0;u<kt;u++)bt[u]=0;for(st=[],u=0;u<p.events.length;u++)if(ht=p.events[u],hr=[],ht.preasigntime)st.push(ht.preasigntime);else for(li=this.getdurations(ht),r=0;r<li.length;r=r+2)st.push(timer[this.tidmangeltildelinger[ht.eventtidmangler[li[r]].index]]);for(r=0;r<st.length;r++)for(ai=st[r],s=0;s<ai.timegroups.length;s++)vi=t.timegroups.indexOf(ai.timegroups[s]),vi>-1&&bt[vi]++;for(r=0;r<kt;r++)ct=bt[r],ct<t.timegroupminimum[r]?f.push(t.timegroupminimum[r]-ct):ct>t.timegroupmaximum[r]&&f.push(ct-t.timegroupmaximum[r])}}f.length>0&&(yi=document.createElement("li"),vt=t.costfunction(f)*t.weight,yi.appendChild(document.createTextNode(t.id+":"+vt.toString()+":"+f.toString())),pi=n?document.getElementById("hardcon"):document.getElementById("softcon"),pi.insertBefore(yi,pi.firstChild),h in it?it[h]+=vt:it[h]=vt)}assert(!0,"-----------");for(tt in it)assert(!0,tt+" "+it[tt]);for(tt in lt)assert(!0,tt+" : "+lt[tt])},n.prototype.getdurations=function(n){for(var f=[],e=!0,t=0,o=n.eventtidmangler.length,i,u,r,s,h;e;)if(this.tidmangeltildelinger[n.eventtidmangler[t].index]!=null){for(f.push(t),i=!0;i;)if(t+2>o)i=!1,e=!1;else if(this.tidmangeltildelinger[n.eventtidmangler[t+1].index]!=null)if(this.tidmangeltildelinger[n.eventtidmangler[t].index]+1==this.tidmangeltildelinger[n.eventtidmangler[t+1].index]){for(u=!1,r=t+1;r<n.eventresmangler.length;r+=n.duration)s=vistsol.resmangeltildelinger[n.eventresmangler[r].index],h=vistsol.resmangeltildelinger[n.eventresmangler[r-1].index],s==h?u=!0:(u=!1,r=n.eventresmangler.length);u||n.eventresmangler.length==0?t++:i=!1}else i=!1;else i=!1;f.push(t++)}else t+2>o?e=!1:t++;return f},n.prototype.getspliteventafvigelse=function(n,t){var h=t.minimumduration,o=t.minimumamount,l=n.id,c=t.maximumduration,s=t.maximumamount,r=this.getdurations(n),u=0,i,e,f;if(r.length>0){for(i=0;i<r.length;i=i+2)e=r[i+1]-r[i]+1,e<h&&u++,e>c&&u++;f=r.length/2,f>s&&(u+=f-s),f<o&&(u+=o-f)}return u},n.prototype.getdistributespliteventafvigelse=function(n,t){var f=t.minimum,s=n.id,e=t.maximum,o=t.duration,u=this.getdurations(n),i,r;if(u.length>0)for(i=0,r=0;r<u.length;r=r+2)u[r+1]-u[r]+1==o&&i++;return i>e?i-e:i<f?f-i:0},n.prototype.randomtidtildel=function(n){for(var i,r,t=0;t<n;t++)i=Math.floor(Math.random()*tidmangler.length),r=Math.floor(Math.random()*antaltider),this.tildeltidtilevent(i,r)},n.prototype.randontildelres=function(n){for(var t,i,r,u,c,f=0;f<n;f++)if(t=Math.floor(Math.random()*resmangler.length),this.resmangeltildelinger[t]==undefined){for(i=-1;i<0;){var o=resmangler[t].resourcetype,h=Math.floor(Math.random()*o.resourcegroups.length),e=o.resourcegroups[h].resourcer,s=Math.floor(Math.random()*e.length);e[s]&&(i=e[s].index)}if(vistsol.resmangeltildelinger[t]=i,resmangler[t].aevent.preasigntime)for(r=resmangler[t].aevent,u=0;u<r.duration;u++)vistsol.tildelresourcetileventtiltid(i,0,r.preasigntime.index+u,r.index)}else c=3},n.prototype.tildeltidtilevent=function(n,t){var i=tidmangler[n].aevent,o=i.index,f=tidmangler[n].durationindex,e,u,s,r;for(this.tidmangeltildelinger[n]!=undefined&&(e=this.tidmangeltildelinger[n]),u=f;u<i.eventresmangler.length;u=u+i.duration)this.resmangeltildelinger[i.eventresmangler[u].index]!==undefined&&(r=this.resmangeltildelinger[i.eventresmangler[u].index],e!==undefined&&this.fratagresourcetileventtiltid(r,f,e,o),t>-1&&this.tildelresourcetileventtiltid(r,f,t,o));for(s=0;s<i.eventresourcer.length;s++)r=i.eventresourcer[s].index,e!==undefined&&this.fratagresourcetileventtiltid(r,f,e,o),t>-1&&this.tildelresourcetileventtiltid(r,f,t,o);this.tidmangeltildelinger[n]=t>-1?t:null},n.prototype.fratagresourcetileventtiltid=function(n,t,i,r){for(var f=this.restiltid[n].tider[i],e=-1,u=0;u<f.durationindex.length;u++)f.durationindex[u]==t&&f.eventindex[u]==r&&(e=u);e>-1&&(f.eventindex.splice(e,1),f.durationindex.splice(e,1))},n.prototype.tildelresourcetileventtiltid=function(n,t,i,r){var u=this.restiltid[n].tider[i];u.eventindex.push(r),u.durationindex.push(t)},n}(),n.Sol=r})(solution||(solution={}))