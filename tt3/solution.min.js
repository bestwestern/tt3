var solution;(function(n){var i=function(){function n(){this.durationindex=[],this.eventindex=[]}return n}(),t,r;n.tildeling=i,t=function(){function n(){this.tider=[];for(var n=0;n<antaltider;n++)this.tider.push(new i)}return n}(),n.restider=t,r=function(){function n(){var n,i,r,u,f;for(this.resmangeltildelinger=[],this.tidmangeltildelinger=[],this.restiltid=[],n=0;n<antalresourcer;n++)this.restiltid[n]=new t;for(n=0;n<antalevents;n++)if(i=events[n],i.preasigntime)for(r=0;r<i.duration;r++)for(u=0;u<i.eventresourcer.length;u++)f=i.eventresourcer[u].index,this.restiltid[f].tider[i.preasigntime.index+r].durationindex.push(r),this.restiltid[f].tider[i.preasigntime.index+r].eventindex.push(i.index)}return n.prototype.udregncon=function(n){for(var ai=n?hardconstraints:softconstraints,b={},yt,pt,wt,k,nr,bt,kt,d,a,v,y,gt,ni,ti,p,ht,bi,s,f,c,ur,t,h,ri,di,ui,lt,gi,l,rt,u,ut,fr,ei,oi,at,si,r,ft,vt,hi,ci,li,i,et=0,vi=ai.length;et<vi;et++){var t=ai[et],e=[],ot=0,o="";if(t instanceof instans.AssignResourceConstraint)for(o="AssignResourceConstraint",t=t,s=t.appliestoresmangler,i=0;i<s.length;i++)f=0,this.resmangeltildelinger[s[i].index]==null&&(s[i].aevent.preasigntime?f+=s[i].aevent.duration:f++),e.push(f);if(t instanceof instans.AssignTimeConstraint)for(o="AssignTimeConstraint",t=t,i=0,h=t.appliestoev.length;i<h;i++){for(f=0,yt=t.appliestoev[i].eventtidmangler,u=0;u<yt.length;u++)this.tidmangeltildelinger[yt[u].index]==null&&f++;e.push(f)}if(t instanceof instans.AvoidSplitAssignmentsConstraint)for(o="AvoidSplitAssignmentsConstraint",t=t,pt=t.arraymedarrayafresmangler,i=0;i<pt.length;i++){for(wt=pt[i],k=[],u=0;u<wt.length;u++)c=this.resmangeltildelinger[wt[u].index],c!=undefined?k.indexOf(c)==-1&&k.push(c):nr=3;k.length>1&&e.push(k.length-1)}if(t instanceof instans.AvoidClashesConstraint)for(t=t,o="AvoidClashesConstraint",i=0;i<t.appliestores.length;i++){for(bt=0,kt=t.appliestores[i].index,d=0;d<antaltider;d++)this.restiltid[kt].tider[d].durationindex.length>1&&(bt+=this.restiltid[kt].tider[d].durationindex.length-1);e.push(bt)}if(t instanceof instans.DistributeSplitEventsConstraint)for(o="DistributeSplitEventsConstraint",t=t,i=0,h=t.appliestoev.length;i<h;i++)f=this.getdistributespliteventafvigelse(t.appliestoev[i],t),f>0&&e.push(f);if(t instanceof instans.AvoidUnavailableTimesConstraint){o="AvoidUnavailableTimesConstraint";var yi=t.timer,tr=yi.length,t=t;for(i=0;i<t.appliestores.length;i++){var a=t.appliestores[i],dt=0,v=this.restiltid[a.index];for(u=0;u<tr;u++)v.tider[yi[u].index].eventindex.length>0&&dt++;dt&&e.push(dt)}}if(t instanceof instans.LimitBusyTimesConstraint){o="LimitBusyTimesConstraint";var pi=t.timegroups,ir=pi.length,g=t.maximum,nt=t.minimum,t=t;for(i=0;i<t.appliestores.length;i++)for(a=t.appliestores[i],v=this.restiltid[a.index],u=0;u<ir;u++){for(y=0,gt=pi[u].timer,r=0;r<gt.length;r++)v.tider[gt[r].index].eventindex.length>0&&y++;y>g?e.push(y-g):y<nt&&e.push(nt-y)}}if(t instanceof instans.LimitWorkloadConstraint){o="LimitWorkloadConstraint ";var t=t,g=t.maximum,nt=t.minimum;for(i=0;i<t.appliestores.length;i++){var a=t.appliestores[i],tt=0,v=this.restiltid[a.index];for(u=0;u<antaltider;u++)for(ni=v.tider[u],r=0;r<ni.eventindex.length;r++)tt+=events[ni.eventindex[r]].workload||1;tt>g?e.push(tt-g):tt<nt&&e.push(nt-tt)}}if(t instanceof instans.LinkEventsConstraint)for(o="LinkEventsConstraint ",t=t,ti=t.appliestoevgrou,i=0;i<ti.length;i++){var l=ti[i],er=l.events[0].duration,st=[],it=[];for(u=0;u<l.events.length;u++){var rr=l.events[u],ii=[],wi=rr.eventtidmangler;for(r=0;r<wi.length;r++)p=this.tidmangeltildelinger[wi[r].index],p!=null&&(ii.indexOf(p)==-1&&ii.push(p),st.indexOf(p)==-1&&st.push(p));it.push(ii)}for(ht=0,u=0;u<st.length;u++){for(bi=st[u],r=0;r<it.length;r++)it[r].indexOf(bi)==-1&&(r=it.length+1);r>it.length&&ht++}ht&&e.push(ht)}if(t instanceof instans.SplitEventsConstraint)for(o="SplitEventsConstraint",t=t,i=0,h=t.appliestoev.length;i<h;i++)f=this.getspliteventafvigelse(t.appliestoev[i],t),f>0&&e.push(f);if(t instanceof instans.PreferResourcesConstraint)for(o="PreferResourcesConstraint",t=t,s=t.appliestoresmangler,i=0;i<s.length;i++)f=0,c=this.resmangeltildelinger[s[i].index],c!=undefined&&t.appliestores.indexOf(resourcer[c])<0&&(s[i].aevent.preasigntime?f+=s[i].aevent.duration:f++),e.push(f);if(t instanceof instans.PreferTimesConstraint)for(o="PreferTimesConstraint",ur=t.duration,t=t,i=0,h=t.appliestoev.length;i<h;i++){var f=0,ki=t.appliestoev[i],w=this.getdurations(ki);for(r=0;r<w.length;r=r+2)ri=!0,"duration"in t&&(ri=w[r+1]-w[r]+1==t.duration),ri&&(di=ki.eventtidmangler[w[r]].index,ui=this.tidmangeltildelinger[di],ui!=null&&t.timer.indexOf(timer[ui])<0&&(f=f+w[r+1]-w[r]+1));e.push(f)}if(t instanceof instans.SpreadEventsConstraint){o="SpreadEventsConstraint";var fi=[],t=t,ct=[];for(i=0;i<lt;i++)ct.push(0);for(lt=t.timegroupminimum.length,i=0,gi=t.appliestoevgrou.length;i<gi;i++){for(l=t.appliestoevgrou[i],u=0;u<lt;u++)ct[u]=0;for(rt=[],u=0;u<l.events.length;u++)if(ut=l.events[u],fr=[],ut.preasigntime)rt.push(ut.preasigntime);else for(ei=this.getdurations(ut),r=0;r<ei.length;r=r+2)rt.push(timer[this.tidmangeltildelinger[ut.eventtidmangler[ei[r]].index]]);for(r=0;r<rt.length;r++)for(oi=rt[r],at=0;at<oi.timegroups.length;at++)si=t.timegroups.indexOf(oi.timegroups[at]),si>-1&&ct[si]++;for(r=0;r<lt;r++)ft=ct[r],vt=0,ft<t.timegroupminimum[r]?(e.push(t.timegroupminimum[r]-ft),vt=1):ft>t.timegroupmaximum[r]&&(e.push(ft-t.timegroupmaximum[r]),vt=1),vt&&fi.push(l.id+":"+e[e.length-1])}}e.length>0&&(hi=document.createElement("li"),ot=t.costfunction(e)*t.weight,hi.appendChild(document.createTextNode(t.id+":"+ot.toString()+":"+e.toString())),ci=n?document.getElementById("hardcon"):document.getElementById("softcon"),ci.insertBefore(hi,ci.firstChild),o in b?b[o]+=ot:b[o]=ot)}assert(!0,"-----------");for(li in b)assert(!0,li+" "+b[li]);for(i=0;i<fi.length;i++)assert(!0,fi[i])},n.prototype.getdurations=function(n){for(var f=[],e=!0,t=0,o=n.eventtidmangler.length,i,u,r,s,h;e;)if(this.tidmangeltildelinger[n.eventtidmangler[t].index]!=null){for(f.push(t),i=!0;i;)if(t+2>o)i=!1,e=!1;else if(this.tidmangeltildelinger[n.eventtidmangler[t+1].index]!=null)if(this.tidmangeltildelinger[n.eventtidmangler[t].index]+1==this.tidmangeltildelinger[n.eventtidmangler[t+1].index]){for(u=!1,r=t+1;r<n.eventresmangler.length;r+=n.duration)s=vistsol.resmangeltildelinger[n.eventresmangler[r].index],h=vistsol.resmangeltildelinger[n.eventresmangler[r-1].index],s==h?u=!0:(u=!1,r=n.eventresmangler.length);u||n.eventresmangler.length==0?t++:i=!1}else i=!1;else i=!1;f.push(t++)}else t+2>o?e=!1:t++;return f},n.prototype.getspliteventafvigelse=function(n,t){var h=t.minimumduration,o=t.minimumamount,l=n.id,c=t.maximumduration,s=t.maximumamount,r=this.getdurations(n),u=0,i,e,f;if(r.length>0){for(i=0;i<r.length;i=i+2)e=r[i+1]-r[i]+1,e<h&&u++,e>c&&u++;f=r.length/2,f>s&&(u+=f-s),f<o&&(u+=o-f)}return u},n.prototype.getdistributespliteventafvigelse=function(n,t){var f=t.minimum,s=n.id,e=t.maximum,o=t.duration,u=this.getdurations(n),i,r;if(u.length>0)for(i=0,r=0;r<u.length;r=r+2)u[r+1]-u[r]+1==o&&i++;return i>e?i-e:i<f?f-i:0},n.prototype.randomtidtildel=function(n){for(var i,r,t=0;t<n;t++)i=Math.floor(Math.random()*tidmangler.length),r=Math.floor(Math.random()*antaltider),this.tildeltidtilevent(i,r)},n.prototype.randontildelres=function(n){for(var t,i,r,c,u=0;u<n;u++)if(t=Math.floor(Math.random()*resmangler.length),this.resmangeltildelinger[t]==undefined){var f=resmangler[t].resourcetype,s=Math.floor(Math.random()*f.resourcegroups.length),e=f.resourcegroups[s].resourcer,h=Math.floor(Math.random()*e.length),o=e[h].index;if(vistsol.resmangeltildelinger[t]=o,resmangler[t].aevent.preasigntime)for(i=resmangler[t].aevent,r=0;r<i.duration;r++)vistsol.tildelresourcetileventtiltid(o,0,i.preasigntime.index+r,i.index)}else c=3},n.prototype.tildeltidtilevent=function(n,t){var i=tidmangler[n].aevent,o=i.index,f=tidmangler[n].durationindex,e,u,s,r;for(this.tidmangeltildelinger[n]!=undefined&&(e=this.tidmangeltildelinger[n]),u=f;u<i.eventresmangler.length;u=u+i.duration)this.resmangeltildelinger[i.eventresmangler[u].index]!==undefined&&(r=this.resmangeltildelinger[i.eventresmangler[u].index],e!==undefined&&this.fratagresourcetileventtiltid(r,f,e,o),t>-1&&this.tildelresourcetileventtiltid(r,f,t,o));for(s=0;s<i.eventresourcer.length;s++)r=i.eventresourcer[s].index,e!==undefined&&this.fratagresourcetileventtiltid(r,f,e,o),t>-1&&this.tildelresourcetileventtiltid(r,f,t,o);this.tidmangeltildelinger[n]=t>-1?t:null},n.prototype.fratagresourcetileventtiltid=function(n,t,i,r){for(var f=this.restiltid[n].tider[i],e=-1,u=0;u<f.durationindex.length;u++)f.durationindex[u]==t&&f.eventindex[u]==r&&(e=u);e>-1&&(f.eventindex.splice(e,1),f.durationindex.splice(e,1))},n.prototype.tildelresourcetileventtiltid=function(n,t,i,r){var u=this.restiltid[n].tider[i];u.eventindex.push(r),u.durationindex.push(t)},n}(),n.Sol=r})(solution||(solution={}))