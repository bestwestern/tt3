var solution;(function(n){var i=function(){function n(){this.durationindex=[],this.eventindex=[]}return n}(),t,r;n.tildeling=i,t=function(){function n(){this.tider=[];for(var n=0;n<antaltider;n++)this.tider.push(new i)}return n}(),n.restider=t,r=function(){function n(){var n,i,r,u,f;for(this.resmangeltildelinger=[],this.tidmangeltildelinger=[],this.restiltid=[],n=0;n<antalresourcer;n++)this.restiltid[n]=new t;for(n=0;n<antalevents;n++)if(i=events[n],i.preasigntime)for(r=0;r<i.duration;r++)for(u=0;u<i.eventresourcer.length;u++)f=i.eventresourcer[u].index,this.restiltid[f].tider[i.preasigntime.index+r].durationindex.push(r),this.restiltid[f].tider[i.preasigntime.index+r].eventindex.push(i.index)}return n.prototype.udregncon=function(n){for(var tr=n?hardconstraints:softconstraints,ut={},ir={},ui,fi,ei,ft,ar,oi,si,et,a,d,nt,ci,ct,ai,gt,o,lt,at,vi,tt,ti,sr,c,e,v,yr,t,l,pi,cr,wi,ri,i,lr,k,yt,u,pt,pr,bi,ki,s,di,r,wt,gi,nr,rt,bt=0,rr=tr.length;bt<rr;bt++){var t=tr[bt],f=[],kt=0,h="";if(t instanceof instans.AssignResourceConstraint)for(h="AssignResourceConstraint",t=t,c=t.appliestoresmangler,i=0;i<c.length;i++)this.resmangeltildelinger[c[i].index]==null&&(c[i].aevent.preasigntime?f.push(c[i].aevent.duration):f.push(1));if(t instanceof instans.AssignTimeConstraint)for(h="AssignTimeConstraint",t=t,i=0,l=t.appliestoev.length;i<l;i++){for(e=0,ui=t.appliestoev[i].eventtidmangler,u=0;u<ui.length;u++)this.tidmangeltildelinger[ui[u].index]==null&&e++;f.push(e)}if(t instanceof instans.AvoidSplitAssignmentsConstraint)for(h="AvoidSplitAssignmentsConstraint",t=t,fi=t.arraymedarrayafresmangler,i=0;i<fi.length;i++){for(ei=fi[i],ft=[],u=0;u<ei.length;u++)v=this.resmangeltildelinger[ei[u].index],v!=undefined?ft.indexOf(v)==-1&&ft.push(v):ar=3;ft.length>1&&f.push(ft.length-1)}if(t instanceof instans.AvoidClashesConstraint)for(t=t,h="AvoidClashesConstraint",i=0;i<t.appliestores.length;i++){for(oi=0,si=t.appliestores[i].index,et=0;et<antaltider;et++)this.restiltid[si].tider[et].durationindex.length>1&&(oi+=this.restiltid[si].tider[et].durationindex.length-1);f.push(oi)}if(t instanceof instans.DistributeSplitEventsConstraint)for(h="DistributeSplitEventsConstraint",t=t,i=0,l=t.appliestoev.length;i<l;i++)e=this.getdistributespliteventafvigelse(t.appliestoev[i],t),e>0&&f.push(e);if(t instanceof instans.AvoidUnavailableTimesConstraint){h="AvoidUnavailableTimesConstraint";var ur=t.timer,vr=ur.length,t=t;for(i=0;i<t.appliestores.length;i++){var a=t.appliestores[i],hi=0,d=this.restiltid[a.index];for(u=0;u<vr;u++)d.tider[ur[u].index].eventindex.length>0&&hi++;hi&&f.push(hi)}}if(t instanceof instans.LimitBusyTimesConstraint){h="LimitBusyTimesConstraint";var g=t.timegroups,fr=g.length,y=t.maximum,p=t.minimum,t=t;for(i=0;i<t.appliestores.length;i++)for(a=t.appliestores[i],d=this.restiltid[a.index],u=0;u<fr;u++){for(nt=0,ci=g[u].timer,r=0;r<ci.length;r++)d.tider[ci[r].index].eventindex.length>0&&nt++;nt>y?f.push(nt-y):nt<p&&f.push(p-nt)}}if(t instanceof instans.LimitIdleTimesConstraint){h="LimitIdleTimesConstraint";var g=t.timegroups,fr=g.length,y=t.maximum,p=t.minimum,t=t;for(i=0;i<t.appliestores.length;i++){var a=t.appliestores[i],dt=0,li=this.restiltid[a.index].tider;for(u=0;u<g.length;u++){for(var ot=g[u].timer,st=0,ht=-1,b=0;ht<0&&b<ot.length;)li[ot[b++].index].eventindex.length&&(ht=b-1);if(ht>-1){for(ct=-1,b=ot.length-1;ct<0&&b>-1;)li[ot[b--].index].eventindex.length&&(ct=b+1);if(ht>-1&&ct>-1)for(r=ht+1;r<ct;r++)li[ot[r].index].eventindex.length||st++;st<p?dt+=p-st:st>y&&(dt+=st-y)}}dt&&f.push(dt)}}if(t instanceof instans.LimitWorkloadConstraint){h="LimitWorkloadConstraint ";var t=t,y=t.maximum,p=t.minimum;for(i=0;i<t.appliestores.length;i++){var a=t.appliestores[i],er=[],w=0,d=this.restiltid[a.index];for(u=0;u<antaltider;u++)for(ai=d.tider[u],r=0;r<ai.eventindex.length;r++)if(gt=ai.eventindex[r],er.indexOf(gt)==-1){for(o=events[gt],er.push(gt),lt=o.eventresmangler,s=0;s<lt.length;s++)this.resmangeltildelinger[lt[s].index]==a.index&&(at=o.preasigntime?o.duration:1,w+=lt[s].workload!=null?lt[s].workload/o.duration*at:o.workload!=null?o.workload/o.duration*at:at);for(s=0;s<o.eventresourcer.length;s++)o.eventresourcer[s]===a&&(w+=o.eventresworkloads[s]!=null?o.eventresworkloads[s]*o.duration:o.workload!=null?o.workload*o.duration:o.duration)}w=Math.ceil(w),w>y?f.push(w-y):w<p&&f.push(p-w)}}if(t instanceof instans.LinkEventsConstraint)for(h="LinkEventsConstraint ",t=t,vi=t.appliestoevgrou,i=0;i<vi.length;i++){var k=vi[i],wr=k.events[0].duration,ni=[],vt=[];for(u=0;u<k.events.length;u++){var o=k.events[u],yi=[],or=o.eventtidmangler;for(r=0;r<or.length;r++)tt=this.tidmangeltildelinger[or[r].index],tt!=null&&(yi.indexOf(tt)==-1&&yi.push(tt),ni.indexOf(tt)==-1&&ni.push(tt));vt.push(yi)}for(ti=0,u=0;u<ni.length;u++){for(sr=ni[u],r=0;r<vt.length;r++)vt[r].indexOf(sr)==-1&&(r=vt.length+1);r>vt.length&&ti++}ti&&f.push(ti)}if(t instanceof instans.SplitEventsConstraint)for(h="SplitEventsConstraint",t=t,i=0,l=t.appliestoev.length;i<l;i++)e=this.getspliteventafvigelse(t.appliestoev[i],t),e>0&&f.push(e);if(t instanceof instans.PreferResourcesConstraint)for(h="PreferResourcesConstraint",t=t,c=t.appliestoresmangler,i=0;i<c.length;i++)e=0,v=this.resmangeltildelinger[c[i].index],v!=undefined&&t.appliestores.indexOf(resourcer[v])<0&&(c[i].aevent.preasigntime?e+=c[i].aevent.duration:e++),f.push(e);if(t instanceof instans.PreferTimesConstraint)for(h="PreferTimesConstraint",yr=t.duration,t=t,i=0,l=t.appliestoev.length;i<l;i++){var e=0,hr=t.appliestoev[i],it=this.getdurations(hr);for(r=0;r<it.length;r=r+2)pi=!0,"duration"in t&&(pi=it[r+1]-it[r]+1==t.duration),pi&&(cr=hr.eventtidmangler[it[r]].index,wi=this.tidmangeltildelinger[cr],wi!=null&&t.timer.indexOf(timer[wi])<0&&(e=e+it[r+1]-it[r]+1));f.push(e)}if(t instanceof instans.SpreadEventsConstraint){h="SpreadEventsConstraint";var t=t,ii=[];for(i=0;i<ri;i++)ii.push(0);for(ri=t.timegroupminimum.length,i=0,lr=t.appliestoevgrou.length;i<lr;i++){for(k=t.appliestoevgrou[i],u=0;u<ri;u++)ii[u]=0;for(yt=[],u=0;u<k.events.length;u++)if(pt=k.events[u],pr=[],pt.preasigntime)yt.push(pt.preasigntime);else for(bi=this.getdurations(pt),r=0;r<bi.length;r=r+2)yt.push(timer[this.tidmangeltildelinger[pt.eventtidmangler[bi[r]].index]]);for(r=0;r<yt.length;r++)for(ki=yt[r],s=0;s<ki.timegroups.length;s++)di=t.timegroups.indexOf(ki.timegroups[s]),di>-1&&ii[di]++;for(r=0;r<ri;r++)wt=ii[r],wt<t.timegroupminimum[r]?f.push(t.timegroupminimum[r]-wt):wt>t.timegroupmaximum[r]&&f.push(wt-t.timegroupmaximum[r])}}f.length>0&&(gi=document.createElement("li"),kt=t.costfunction(f)*t.weight,gi.appendChild(document.createTextNode(t.id+":"+kt.toString()+":"+f.toString())),nr=n?document.getElementById("hardcon"):document.getElementById("softcon"),nr.insertBefore(gi,nr.firstChild),h in ut?ut[h]+=kt:ut[h]=kt)}assert(!0,"-----------");for(rt in ut)assert(!0,rt+" "+ut[rt]);for(rt in ir)assert(!0,rt+" : "+ir[rt])},n.prototype.getdurations=function(n){for(var f=[],e=!0,t=0,o=n.eventtidmangler.length,i,u,r,s,h;e;)if(this.tidmangeltildelinger[n.eventtidmangler[t].index]!=null){for(f.push(t),i=!0;i;)if(t+2>o)i=!1,e=!1;else if(this.tidmangeltildelinger[n.eventtidmangler[t+1].index]!=null)if(this.tidmangeltildelinger[n.eventtidmangler[t].index]+1==this.tidmangeltildelinger[n.eventtidmangler[t+1].index]){for(u=!1,r=t+1;r<n.eventresmangler.length;r+=n.duration)s=vistsol.resmangeltildelinger[n.eventresmangler[r].index],h=vistsol.resmangeltildelinger[n.eventresmangler[r-1].index],s==h?u=!0:(u=!1,r=n.eventresmangler.length);u||n.eventresmangler.length==0?t++:i=!1}else i=!1;else i=!1;f.push(t++)}else t+2>o?e=!1:t++;return f},n.prototype.getspliteventafvigelse=function(n,t){var h=t.minimumduration,o=t.minimumamount,l=n.id,c=t.maximumduration,s=t.maximumamount,r=this.getdurations(n),u=0,i,e,f;if(r.length>0){for(i=0;i<r.length;i=i+2)e=r[i+1]-r[i]+1,e<h&&u++,e>c&&u++;f=r.length/2,f>s&&(u+=f-s),f<o&&(u+=o-f)}return u},n.prototype.getdistributespliteventafvigelse=function(n,t){var f=t.minimum,s=n.id,e=t.maximum,o=t.duration,u=this.getdurations(n),i,r;if(u.length>0)for(i=0,r=0;r<u.length;r=r+2)u[r+1]-u[r]+1==o&&i++;return i>e?i-e:i<f?f-i:0},n.prototype.randomtidtildel=function(n){for(var i,r,t=0;t<n;t++)i=Math.floor(Math.random()*tidmangler.length),r=Math.floor(Math.random()*antaltider),this.tildeltidtilevent(i,r)},n.prototype.randontildelres=function(n){for(var t,i,r,u,c,f=0;f<n;f++)if(t=Math.floor(Math.random()*resmangler.length),this.resmangeltildelinger[t]==undefined){for(i=-1;i<0;){var o=resmangler[t].resourcetype,h=Math.floor(Math.random()*o.resourcegroups.length),e=o.resourcegroups[h].resourcer,s=Math.floor(Math.random()*e.length);e[s]&&(i=e[s].index)}if(vistsol.resmangeltildelinger[t]=i,resmangler[t].aevent.preasigntime)for(r=resmangler[t].aevent,u=0;u<r.duration;u++)vistsol.tildelresourcetileventtiltid(i,0,r.preasigntime.index+u,r.index)}else c=3},n.prototype.tildeltidtilevent=function(n,t){var i=tidmangler[n].aevent,o=i.index,f=tidmangler[n].durationindex,e,u,s,r;for(this.tidmangeltildelinger[n]!=undefined&&(e=this.tidmangeltildelinger[n]),u=f;u<i.eventresmangler.length;u=u+i.duration)this.resmangeltildelinger[i.eventresmangler[u].index]!==undefined&&(r=this.resmangeltildelinger[i.eventresmangler[u].index],e!==undefined&&this.fratagresourcetileventtiltid(r,f,e,o),t>-1&&this.tildelresourcetileventtiltid(r,f,t,o));for(s=0;s<i.eventresourcer.length;s++)r=i.eventresourcer[s].index,e!==undefined&&this.fratagresourcetileventtiltid(r,f,e,o),t>-1&&this.tildelresourcetileventtiltid(r,f,t,o);this.tidmangeltildelinger[n]=t>-1?t:null},n.prototype.fratagresourcetileventtiltid=function(n,t,i,r){for(var f=this.restiltid[n].tider[i],e=-1,u=0;u<f.durationindex.length;u++)f.durationindex[u]==t&&f.eventindex[u]==r&&(e=u);e>-1&&(f.eventindex.splice(e,1),f.durationindex.splice(e,1))},n.prototype.tildelresourcetileventtiltid=function(n,t,i,r){var u=this.restiltid[n].tider[i];u.eventindex.push(r),u.durationindex.push(t)},n}(),n.Sol=r})(solution||(solution={}))