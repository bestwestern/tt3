var solution;(function(n){var i=function(){function n(){this.durationindex=[],this.eventindex=[]}return n}(),t,r;n.tildeling=i,t=function(){function n(){this.tider=[];for(var n=0;n<antaltider;n++)this.tider.push(new i)}return n}(),n.restider=t,r=function(){function n(){var n,i,r,u,f;for(this.resmangeltildelinger=[],this.tidmangeltildelinger=[],this.restiltid=[],n=0;n<antalresourcer;n++)this.restiltid[n]=new t;for(n=0;n<antalevents;n++)if(i=events[n],i.preasigntime)for(r=0;r<i.duration;r++)for(u=0;u<i.eventresourcer.length;u++)f=i.eventresourcer[u].index,this.restiltid[f].tider[i.preasigntime.index+r].durationindex.push(r),this.restiltid[f].tider[i.preasigntime.index+r].eventindex.push(i.index)}return n.prototype.udregncon=function(n){for(var pi=n?hardconstraints:softconstraints,it={},ct={},kt,dt,gt,rt,ur,ni,ti,ut,v,w,d,ri,ui,vt,h,ft,fi,ei,g,pt,nr,c,e,y,or,t,l,si,ir,hi,bt,i,rr,p,ot,u,st,sr,ci,li,o,ai,r,ht,vi,yi,tt,lt=0,wi=pi.length;lt<wi;lt++){var t=pi[lt],f=[],at=0,s="";if(t instanceof instans.AssignResourceConstraint)for(s="AssignResourceConstraint",t=t,c=t.appliestoresmangler,i=0;i<c.length;i++)this.resmangeltildelinger[c[i].index]==null&&(c[i].aevent.preasigntime?f.push(c[i].aevent.duration):f.push(1));if(t instanceof instans.AssignTimeConstraint)for(s="AssignTimeConstraint",t=t,i=0,l=t.appliestoev.length;i<l;i++){for(e=0,kt=t.appliestoev[i].eventtidmangler,u=0;u<kt.length;u++)this.tidmangeltildelinger[kt[u].index]==null&&e++;f.push(e)}if(t instanceof instans.AvoidSplitAssignmentsConstraint)for(s="AvoidSplitAssignmentsConstraint",t=t,dt=t.arraymedarrayafresmangler,i=0;i<dt.length;i++){for(gt=dt[i],rt=[],u=0;u<gt.length;u++)y=this.resmangeltildelinger[gt[u].index],y!=undefined?rt.indexOf(y)==-1&&rt.push(y):ur=3;rt.length>1&&f.push(rt.length-1)}if(t instanceof instans.AvoidClashesConstraint)for(t=t,s="AvoidClashesConstraint",i=0;i<t.appliestores.length;i++){for(ni=0,ti=t.appliestores[i].index,ut=0;ut<antaltider;ut++)this.restiltid[ti].tider[ut].durationindex.length>1&&(ni+=this.restiltid[ti].tider[ut].durationindex.length-1);f.push(ni)}if(t instanceof instans.DistributeSplitEventsConstraint)for(s="DistributeSplitEventsConstraint",t=t,i=0,l=t.appliestoev.length;i<l;i++)e=this.getdistributespliteventafvigelse(t.appliestoev[i],t),e>0&&f.push(e);if(t instanceof instans.AvoidUnavailableTimesConstraint){s="AvoidUnavailableTimesConstraint";var bi=t.timer,fr=bi.length,t=t;for(i=0;i<t.appliestores.length;i++){var v=t.appliestores[i],ii=0,w=this.restiltid[v.index];for(u=0;u<fr;u++)w.tider[bi[u].index].eventindex.length>0&&ii++;ii&&f.push(ii)}}if(t instanceof instans.LimitBusyTimesConstraint){s="LimitBusyTimesConstraint";var ki=t.timegroups,er=ki.length,b=t.maximum,k=t.minimum,t=t;for(i=0;i<t.appliestores.length;i++)for(v=t.appliestores[i],w=this.restiltid[v.index],u=0;u<er;u++){for(d=0,ri=ki[u].timer,r=0;r<ri.length;r++)w.tider[ri[r].index].eventindex.length>0&&d++;d>b?f.push(d-b):d<k&&f.push(k-d)}}if(t instanceof instans.LimitWorkloadConstraint){s="LimitWorkloadConstraint ";var t=t,b=t.maximum,k=t.minimum;for(i=0;i<t.appliestores.length;i++){var v=t.appliestores[i],di=[],a=0,w=this.restiltid[v.index];for(u=0;u<antaltider;u++)for(ui=w.tider[u],r=0;r<ui.eventindex.length;r++)if(vt=ui.eventindex[r],di.indexOf(vt)==-1){for(h=events[vt],di.push(vt),ft=h.eventresmangler,o=0;o<ft.length;o++)this.resmangeltildelinger[ft[o].index]==v.index&&(ft[o].workload!=null?a+=ft[o].workload:h.workload!=null?a+=h.workload:a++);for(o=0;o<h.eventresourcer.length;o++)h.eventresourcer[o]===v&&(a+=h.eventresworkloads[o]!==null?h.eventresworkloads[o]/h.duration:h.workload!=null?h.workload/h.duration:h.duration)}fi=v.id+"___"+t.id,a>b?(f.push(a-b),ct[fi]=a-b):a<k&&(f.push(k-a),ct[fi]=k-a)}}if(t instanceof instans.LinkEventsConstraint)for(s="LinkEventsConstraint ",t=t,ei=t.appliestoevgrou,i=0;i<ei.length;i++){var p=ei[i],hr=p.events[0].duration,yt=[],et=[];for(u=0;u<p.events.length;u++){var h=p.events[u],oi=[],gi=h.eventtidmangler;for(r=0;r<gi.length;r++)g=this.tidmangeltildelinger[gi[r].index],g!=null&&(oi.indexOf(g)==-1&&oi.push(g),yt.indexOf(g)==-1&&yt.push(g));et.push(oi)}for(pt=0,u=0;u<yt.length;u++){for(nr=yt[u],r=0;r<et.length;r++)et[r].indexOf(nr)==-1&&(r=et.length+1);r>et.length&&pt++}pt&&f.push(pt)}if(t instanceof instans.SplitEventsConstraint)for(s="SplitEventsConstraint",t=t,i=0,l=t.appliestoev.length;i<l;i++)e=this.getspliteventafvigelse(t.appliestoev[i],t),e>0&&f.push(e);if(t instanceof instans.PreferResourcesConstraint)for(s="PreferResourcesConstraint",t=t,c=t.appliestoresmangler,i=0;i<c.length;i++)e=0,y=this.resmangeltildelinger[c[i].index],y!=undefined&&t.appliestores.indexOf(resourcer[y])<0&&(c[i].aevent.preasigntime?e+=c[i].aevent.duration:e++),f.push(e);if(t instanceof instans.PreferTimesConstraint)for(s="PreferTimesConstraint",or=t.duration,t=t,i=0,l=t.appliestoev.length;i<l;i++){var e=0,tr=t.appliestoev[i],nt=this.getdurations(tr);for(r=0;r<nt.length;r=r+2)si=!0,"duration"in t&&(si=nt[r+1]-nt[r]+1==t.duration),si&&(ir=tr.eventtidmangler[nt[r]].index,hi=this.tidmangeltildelinger[ir],hi!=null&&t.timer.indexOf(timer[hi])<0&&(e=e+nt[r+1]-nt[r]+1));f.push(e)}if(t instanceof instans.SpreadEventsConstraint){s="SpreadEventsConstraint";var t=t,wt=[];for(i=0;i<bt;i++)wt.push(0);for(bt=t.timegroupminimum.length,i=0,rr=t.appliestoevgrou.length;i<rr;i++){for(p=t.appliestoevgrou[i],u=0;u<bt;u++)wt[u]=0;for(ot=[],u=0;u<p.events.length;u++)if(st=p.events[u],sr=[],st.preasigntime)ot.push(st.preasigntime);else for(ci=this.getdurations(st),r=0;r<ci.length;r=r+2)ot.push(timer[this.tidmangeltildelinger[st.eventtidmangler[ci[r]].index]]);for(r=0;r<ot.length;r++)for(li=ot[r],o=0;o<li.timegroups.length;o++)ai=t.timegroups.indexOf(li.timegroups[o]),ai>-1&&wt[ai]++;for(r=0;r<bt;r++)ht=wt[r],ht<t.timegroupminimum[r]?f.push(t.timegroupminimum[r]-ht):ht>t.timegroupmaximum[r]&&f.push(ht-t.timegroupmaximum[r])}}f.length>0&&(vi=document.createElement("li"),at=t.costfunction(f)*t.weight,vi.appendChild(document.createTextNode(t.id+":"+at.toString()+":"+f.toString())),yi=n?document.getElementById("hardcon"):document.getElementById("softcon"),yi.insertBefore(vi,yi.firstChild),s in it?it[s]+=at:it[s]=at)}assert(!0,"-----------");for(tt in it)assert(!0,tt+" "+it[tt]);for(tt in ct)assert(!0,tt+" : "+ct[tt])},n.prototype.getdurations=function(n){for(var f=[],e=!0,t=0,o=n.eventtidmangler.length,i,u,r,s,h;e;)if(this.tidmangeltildelinger[n.eventtidmangler[t].index]!=null){for(f.push(t),i=!0;i;)if(t+2>o)i=!1,e=!1;else if(this.tidmangeltildelinger[n.eventtidmangler[t+1].index]!=null)if(this.tidmangeltildelinger[n.eventtidmangler[t].index]+1==this.tidmangeltildelinger[n.eventtidmangler[t+1].index]){for(u=!1,r=t+1;r<n.eventresmangler.length;r+=n.duration)s=vistsol.resmangeltildelinger[n.eventresmangler[r].index],h=vistsol.resmangeltildelinger[n.eventresmangler[r-1].index],s==h?u=!0:(u=!1,r=n.eventresmangler.length);u||n.eventresmangler.length==0?t++:i=!1}else i=!1;else i=!1;f.push(t++)}else t+2>o?e=!1:t++;return f},n.prototype.getspliteventafvigelse=function(n,t){var h=t.minimumduration,o=t.minimumamount,l=n.id,c=t.maximumduration,s=t.maximumamount,r=this.getdurations(n),u=0,i,e,f;if(r.length>0){for(i=0;i<r.length;i=i+2)e=r[i+1]-r[i]+1,e<h&&u++,e>c&&u++;f=r.length/2,f>s&&(u+=f-s),f<o&&(u+=o-f)}return u},n.prototype.getdistributespliteventafvigelse=function(n,t){var f=t.minimum,s=n.id,e=t.maximum,o=t.duration,u=this.getdurations(n),i,r;if(u.length>0)for(i=0,r=0;r<u.length;r=r+2)u[r+1]-u[r]+1==o&&i++;return i>e?i-e:i<f?f-i:0},n.prototype.randomtidtildel=function(n){for(var i,r,t=0;t<n;t++)i=Math.floor(Math.random()*tidmangler.length),r=Math.floor(Math.random()*antaltider),this.tildeltidtilevent(i,r)},n.prototype.randontildelres=function(n){for(var t,i,r,u,c,f=0;f<n;f++)if(t=Math.floor(Math.random()*resmangler.length),this.resmangeltildelinger[t]==undefined){for(i=-1;i<0;){var o=resmangler[t].resourcetype,h=Math.floor(Math.random()*o.resourcegroups.length),e=o.resourcegroups[h].resourcer,s=Math.floor(Math.random()*e.length);e[s]&&(i=e[s].index)}if(vistsol.resmangeltildelinger[t]=i,resmangler[t].aevent.preasigntime)for(r=resmangler[t].aevent,u=0;u<r.duration;u++)vistsol.tildelresourcetileventtiltid(i,0,r.preasigntime.index+u,r.index)}else c=3},n.prototype.tildeltidtilevent=function(n,t){var i=tidmangler[n].aevent,o=i.index,f=tidmangler[n].durationindex,e,u,s,r;for(this.tidmangeltildelinger[n]!=undefined&&(e=this.tidmangeltildelinger[n]),u=f;u<i.eventresmangler.length;u=u+i.duration)this.resmangeltildelinger[i.eventresmangler[u].index]!==undefined&&(r=this.resmangeltildelinger[i.eventresmangler[u].index],e!==undefined&&this.fratagresourcetileventtiltid(r,f,e,o),t>-1&&this.tildelresourcetileventtiltid(r,f,t,o));for(s=0;s<i.eventresourcer.length;s++)r=i.eventresourcer[s].index,e!==undefined&&this.fratagresourcetileventtiltid(r,f,e,o),t>-1&&this.tildelresourcetileventtiltid(r,f,t,o);this.tidmangeltildelinger[n]=t>-1?t:null},n.prototype.fratagresourcetileventtiltid=function(n,t,i,r){for(var f=this.restiltid[n].tider[i],e=-1,u=0;u<f.durationindex.length;u++)f.durationindex[u]==t&&f.eventindex[u]==r&&(e=u);e>-1&&(f.eventindex.splice(e,1),f.durationindex.splice(e,1))},n.prototype.tildelresourcetileventtiltid=function(n,t,i,r){var u=this.restiltid[n].tider[i];u.eventindex.push(r),u.durationindex.push(t)},n}(),n.Sol=r})(solution||(solution={}))